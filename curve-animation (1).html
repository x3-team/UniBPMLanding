<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Анимация кривой со стрелкой</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #f5f5f5;
        }
        
        svg {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <svg width="600" height="400" viewBox="0 0 600 400">
        <defs>
            <!-- Фильтр для свечения точки -->
            <filter id="glow">
                <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                <feMerge>
                    <feMergeNode in="coloredBlur"/>
                    <feMergeNode in="SourceGraphic"/>
                </feMerge>
            </filter>
            
            <!-- Градиент прозрачности для следа -->
            <linearGradient id="trailGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#5BA3F5;stop-opacity:0" />
                <stop offset="30%" style="stop-color:#5BA3F5;stop-opacity:0.3" />
                <stop offset="70%" style="stop-color:#5BA3F5;stop-opacity:0.8" />
                <stop offset="100%" style="stop-color:#5BA3F5;stop-opacity:1" />
            </linearGradient>
        </defs>
        
        <!-- Полная кривая (светлая серая) -->
        <path id="fullPath" 
              d="M 100 80 Q 200 60, 300 150 T 500 280"
              fill="none"
              stroke="#D0D0D0"
              stroke-width="4"
              stroke-linecap="round"/>
        
        <!-- Анимированный синий сегмент -->
        <path id="animatedPath"
              d="M 100 80 Q 200 60, 300 150 T 500 280"
              fill="none"
              stroke="url(#trailGradient)"
              stroke-width="4"
              stroke-linecap="round"/>
        
        <!-- Светящаяся точка на конце синего сегмента -->
        <circle id="movingCircle" r="8" fill="#5BA3F5" filter="url(#glow)"/>
        
        <!-- Круг на конце кривой -->
        <circle id="endCircle" cx="500" cy="280" r="12" fill="none" stroke="#D0D0D0" stroke-width="3"/>
    </svg>

    <script>
        const path = document.getElementById('fullPath');
        const animatedPath = document.getElementById('animatedPath');
        const circle = document.getElementById('movingCircle');
        const gradient = document.getElementById('trailGradient');
        const endCircle = document.getElementById('endCircle');
        
        const pathLength = path.getTotalLength();
        const duration = 4000; // 4 секунды
        const trailLength = 200; // длина синего следа
        
        let startTime = null;
        
        function animate(timestamp) {
            if (!startTime) startTime = timestamp;
            
            const elapsed = (timestamp - startTime) % duration;
            const progress = elapsed / duration;
            
            // Позиция точки
            const currentLength = pathLength * progress;
            const point = path.getPointAtLength(currentLength);
            
            // Обновляем позицию круга
            circle.setAttribute('cx', point.x);
            circle.setAttribute('cy', point.y);
            
            // Обновляем синий след (от начала до текущей позиции)
            const startOffset = Math.max(0, currentLength - trailLength);
            animatedPath.style.strokeDasharray = `${currentLength - startOffset} ${pathLength}`;
            animatedPath.style.strokeDashoffset = -startOffset;
            
            // Обновляем градиент чтобы он двигался вместе со следом
            // Вычисляем позиции начала и конца следа
            const trailStart = path.getPointAtLength(startOffset);
            const trailEnd = point;
            
            gradient.setAttribute('x1', `${trailStart.x}`);
            gradient.setAttribute('y1', `${trailStart.y}`);
            gradient.setAttribute('x2', `${trailEnd.x}`);
            gradient.setAttribute('y2', `${trailEnd.y}`);
            gradient.setAttribute('gradientUnits', 'userSpaceOnUse');
            
            // Проверяем близость к концу пути и меняем цвет конечного круга
            const distanceToEnd = pathLength - currentLength;
            if (distanceToEnd < 20) {
                // Попала линия - круг синий
                endCircle.setAttribute('stroke', '#5BA3F5');
                endCircle.setAttribute('stroke-width', '3');
            } else {
                // Обычное состояние - круг серый
                endCircle.setAttribute('stroke', '#D0D0D0');
                endCircle.setAttribute('stroke-width', '3');
            }
            
            requestAnimationFrame(animate);
        }
        
        requestAnimationFrame(animate);
    </script>
</body>
</html>
